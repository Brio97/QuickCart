# ðŸš€ QuickCart Production Deployment Guide

This guide will walk you through deploying QuickCart to production using Vercel (frontend), Render (backend), and Turso (database).

## Prerequisites

1. **GitHub Repository**: Push your code to GitHub
2. **Accounts**: Create accounts on:
   - [Vercel](https://vercel.com) 
   - [Render](https://render.com)
   - [Turso](https://turso.tech)

## Step 1: Set Up Turso Database

### 1.1 Install Turso CLI
```bash
# macOS/Linux
curl -sSfL https://get.tur.so/install.sh | bash

# Windows (PowerShell)
iwr -useb https://get.tur.so/install.ps1 | iex
```

### 1.2 Create Turso Database
```bash
# Login to Turso
turso auth login

# Create database
turso db create quickcart-prod

# Get database URL
turso db show quickcart-prod

# Create auth token
turso db tokens create quickcart-prod
```

### 1.3 Initialize Database Schema
```bash
# Get database shell access
turso db shell quickcart-prod

# Create tables (copy the SQL from your local database or run migration)
.schema
```

**Save these values for later:**
- `TURSO_DATABASE_URL`: The libsql:// URL from `turso db show`
- `TURSO_AUTH_TOKEN`: The token from `turso db tokens create`

## Step 2: Deploy Backend to Render

### 2.1 Create Render Web Service

1. Go to [Render Dashboard](https://dashboard.render.com)
2. Click "New +" â†’ "Web Service"
3. Connect your GitHub repository
4. Configure:
   - **Name**: `quickcart-api`
   - **Region**: Choose closest to your users
   - **Branch**: `main`
   - **Runtime**: `Python 3`
   - **Build Command**: `cd server && pip install -r ../requirements.txt`
   - **Start Command**: `cd server && python run.py`

### 2.2 Set Environment Variables

In Render dashboard, add these environment variables:

```
SECRET_KEY=<auto-generated-by-render>
FLASK_ENV=production
TURSO_DATABASE_URL=<your-turso-database-url>
TURSO_AUTH_TOKEN=<your-turso-auth-token>
FRONTEND_URL=https://your-app.vercel.app
```

### 2.3 Deploy

Click "Create Web Service" and wait for deployment to complete.

**Save your Render URL**: `https://your-app-name.onrender.com`

## Step 3: Deploy Frontend to Vercel

### 3.1 Install Vercel CLI (Optional)
```bash
npm i -g vercel
```

### 3.2 Deploy via Vercel Dashboard

1. Go to [Vercel Dashboard](https://vercel.com/dashboard)
2. Click "New Project"
3. Import your GitHub repository
4. Configure:
   - **Framework Preset**: Vite
   - **Root Directory**: `client`
   - **Build Command**: `npm run build`
   - **Output Directory**: `dist`

### 3.3 Set Environment Variables

In Vercel dashboard â†’ Settings â†’ Environment Variables:

```
VITE_API_URL=https://your-quickcart-api.onrender.com/api
```

### 3.4 Deploy

Click "Deploy" and wait for deployment to complete.

## Step 4: Update CORS Configuration

1. Go back to Render dashboard
2. Update the `FRONTEND_URL` environment variable:
   ```
   FRONTEND_URL=https://your-app.vercel.app
   ```
3. Redeploy the backend service

## Step 5: Test Production Deployment

1. Visit your Vercel URL
2. Test user registration and login
3. Test product browsing and cart functionality
4. Check browser console for any errors

## Environment Variables Summary

### Backend (Render)
```env
SECRET_KEY=<auto-generated>
FLASK_ENV=production
TURSO_DATABASE_URL=libsql://your-database.turso.io
TURSO_AUTH_TOKEN=your-turso-auth-token
FRONTEND_URL=https://your-app.vercel.app
```

### Frontend (Vercel)
```env
VITE_API_URL=https://your-quickcart-api.onrender.com/api
```

## Monitoring and Maintenance

### Check Service Health
- **Backend**: `https://your-api.onrender.com/api/health`
- **Frontend**: Your Vercel URL should load successfully

### View Logs
- **Render**: Dashboard â†’ Service â†’ Logs
- **Vercel**: Dashboard â†’ Project â†’ Functions â†’ View Logs

### Database Management
```bash
# Connect to production database
turso db shell quickcart-prod

# View tables
.tables

# Check data
SELECT COUNT(*) FROM products;
SELECT COUNT(*) FROM users;
```

## Troubleshooting

### Common Issues

1. **CORS Errors**: Ensure `FRONTEND_URL` is correctly set in Render
2. **Database Connection**: Verify Turso credentials and URL format
3. **Build Failures**: Check build logs in respective dashboards
4. **API Errors**: Check Render logs for backend issues

### Useful Commands
```bash
# Test API endpoint
curl https://your-api.onrender.com/api/health

# Check database connection
turso db shell quickcart-prod
```

## Security Considerations

1. **Rotate Secrets**: Regularly rotate `SECRET_KEY` and database tokens
2. **HTTPS Only**: Ensure all production URLs use HTTPS
3. **Environment Variables**: Never commit sensitive data to Git
4. **CORS**: Keep CORS origins restrictive to your domains only

## Cost Optimization

- **Render**: Free tier includes 500 build hours/month
- **Vercel**: Free tier includes 100GB bandwidth/month  
- **Turso**: Free tier includes 9GB storage + 1B row reads

Monitor usage in respective dashboards to avoid overages.

---

ðŸŽ‰ **Congratulations!** Your QuickCart application is now live in production!

- **Frontend**: https://your-app.vercel.app
- **Backend**: https://your-api.onrender.com
- **Database**: Turso (managed)
